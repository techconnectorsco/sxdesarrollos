<script lang="ts">
    // âœ… CAMBIO: Binding directo al padre
    let { datos = $bindable() } = $props();
    
    // Arrays de configuraciÃ³n de amenidades
    const serviciosBasicos = [
        { key: 'agua', label: 'Agua', icon: 'ğŸ’§' },
        { key: 'electricidad', label: 'Electricidad', icon: 'âš¡' },
        { key: 'internet', label: 'Internet', icon: 'ğŸ“¡' },
        { key: 'gas', label: 'Gas', icon: 'ğŸ”¥' },
        { key: 'alcantarillado', label: 'Alcantarillado', icon: 'ğŸš°' },
        { key: 'telefono', label: 'TelÃ©fono', icon: 'â˜ï¸' },
        { key: 'cable', label: 'Cable TV', icon: 'ğŸ“º' }
    ];
    
    const seguridad = [
        { key: 'seguridad_privada', label: 'Seguridad Privada', icon: 'ğŸ‘®' },
        { key: 'portero_electronico', label: 'Portero ElectrÃ³nico', icon: 'ğŸ””' },
        { key: 'camaras_seguridad', label: 'CÃ¡maras de Seguridad', icon: 'ğŸ“¹' },
        { key: 'alarma', label: 'Alarma', icon: 'ğŸš¨' }
    ];
    
    const comodidades = [
        { key: 'piscina', label: 'Piscina', icon: 'ğŸŠ' },
        { key: 'jardin', label: 'JardÃ­n', icon: 'ğŸŒ³' },
        { key: 'terraza', label: 'Terraza', icon: 'ğŸ¡' },
        { key: 'balcon', label: 'BalcÃ³n', icon: 'ğŸªŸ' },
        { key: 'sala_estar', label: 'Sala de Estar', icon: 'ğŸ›‹ï¸' },
        { key: 'cuarto_servicio', label: 'Cuarto de Servicio', icon: 'ğŸšª' },
        { key: 'walk_in_closet', label: 'Walk-in Closet', icon: 'ğŸ‘”' }
    ];
    
    const espaciosAdicionales = [
        { key: 'estudio', label: 'Estudio', icon: 'ğŸ“š' },
        { key: 'oficina', label: 'Oficina', icon: 'ğŸ’¼' },
        { key: 'gimnasio', label: 'Gimnasio', icon: 'ğŸ‹ï¸' },
        { key: 'area_lavanderia', label: 'Ãrea de LavanderÃ­a', icon: 'ğŸ§º' },
        { key: 'barbacoa', label: 'Barbacoa/Rancho', icon: 'ğŸ–' }
    ];
    
    const caracteristicas = [
        { key: 'aire_acondicionado', label: 'Aire Acondicionado', icon: 'â„ï¸' },
        { key: 'calefaccion', label: 'CalefacciÃ³n', icon: 'ğŸ”¥' },
        { key: 'agua_caliente', label: 'Agua Caliente', icon: 'ğŸš¿' }
    ];
    
    const inclusiones = [
        { key: 'electrodomesticos_incluidos', label: 'ElectrodomÃ©sticos Incluidos', icon: 'ğŸ”Œ' },
        { key: 'muebles_incluidos', label: 'Muebles Incluidos', icon: 'ğŸª‘' },
        { key: 'amueblado', label: 'Completamente Amueblado', icon: 'ğŸ ' }
    ];
    
    const accesibilidad = [
        { key: 'pet_friendly', label: 'Pet Friendly (Mascotas)', icon: 'ğŸ•' },
        { key: 'discapacitados', label: 'Accesible para Discapacitados', icon: 'â™¿' }
    ];
    
    const ubicacionVentajas = [
        { key: 'vista_panoramica', label: 'Vista PanorÃ¡mica', icon: 'ğŸŒ„' },
        { key: 'esquinera', label: 'Propiedad Esquinera', icon: 'ğŸ”²' },
        { key: 'cerca_transporte_publico', label: 'Cerca de Transporte PÃºblico', icon: 'ğŸšŒ' },
        { key: 'cerca_centros_comerciales', label: 'Cerca de Centros Comerciales', icon: 'ğŸ›’' },
        { key: 'cerca_escuelas', label: 'Cerca de Escuelas', icon: 'ğŸ«' },
        { key: 'cerca_hospitales', label: 'Cerca de Hospitales', icon: 'ğŸ¥' },
        { key: 'cerca_parques', label: 'Cerca de Parques', icon: 'ğŸŒ³' }
    ];
</script>

<div class="paso-contenido">
    <h2>Servicios y Amenidades</h2>
    <p class="subtitulo">Seleccione las caracterÃ­sticas que tiene la propiedad</p>
    
    <div class="subseccion">
        <h3>Servicios BÃ¡sicos</h3>
        <div class="amenidades-grid">
            {#each serviciosBasicos as servicio}
                <label class="amenidad-card">
                    <input 
                        type="checkbox" 
                        bind:checked={datos[servicio.key]}
                    />
                    <div class="amenidad-content">
                        <span class="amenidad-icon">{servicio.icon}</span>
                        <span class="amenidad-label">{servicio.label}</span>
                    </div>
                </label>
            {/each}
        </div>
    </div>
    
    <div class="subseccion">
        <h3>Seguridad</h3>
        <div class="amenidades-grid">
            {#each seguridad as item}
                <label class="amenidad-card">
                    <input 
                        type="checkbox" 
                        bind:checked={datos[item.key]}
                    />
                    <div class="amenidad-content">
                        <span class="amenidad-icon">{item.icon}</span>
                        <span class="amenidad-label">{item.label}</span>
                    </div>
                </label>
            {/each}
        </div>
    </div>
    
    <div class="subseccion">
        <h3>Comodidades</h3>
        <div class="amenidades-grid">
            {#each comodidades as item}
                <label class="amenidad-card">
                    <input 
                        type="checkbox" 
                        bind:checked={datos[item.key]}
                    />
                    <div class="amenidad-content">
                        <span class="amenidad-icon">{item.icon}</span>
                        <span class="amenidad-label">{item.label}</span>
                    </div>
                </label>
            {/each}
        </div>
    </div>
    
    <div class="subseccion">
        <h3>Espacios Adicionales</h3>
        <div class="amenidades-grid">
            {#each espaciosAdicionales as item}
                <label class="amenidad-card">
                    <input 
                        type="checkbox" 
                        bind:checked={datos[item.key]}
                    />
                    <div class="amenidad-content">
                        <span class="amenidad-icon">{item.icon}</span>
                        <span class="amenidad-label">{item.label}</span>
                    </div>
                </label>
            {/each}
        </div>
    </div>
    
    <div class="subseccion">
        <h3>CaracterÃ­sticas ClimÃ¡ticas</h3>
        <div class="amenidades-grid">
            {#each caracteristicas as item}
                <label class="amenidad-card">
                    <input 
                        type="checkbox" 
                        bind:checked={datos[item.key]}
                    />
                    <div class="amenidad-content">
                        <span class="amenidad-icon">{item.icon}</span>
                        <span class="amenidad-label">{item.label}</span>
                    </div>
                </label>
            {/each}
        </div>
    </div>
    
    <div class="subseccion">
        <h3>Inclusiones</h3>
        <div class="amenidades-grid">
            {#each inclusiones as item}
                <label class="amenidad-card">
                    <input 
                        type="checkbox" 
                        bind:checked={datos[item.key]}
                    />
                    <div class="amenidad-content">
                        <span class="amenidad-icon">{item.icon}</span>
                        <span class="amenidad-label">{item.label}</span>
                    </div>
                </label>
            {/each}
        </div>
    </div>
    
    <div class="subseccion">
        <h3>Accesibilidad</h3>
        <div class="amenidades-grid">
            {#each accesibilidad as item}
                <label class="amenidad-card">
                    <input 
                        type="checkbox" 
                        bind:checked={datos[item.key]}
                    />
                    <div class="amenidad-content">
                        <span class="amenidad-icon">{item.icon}</span>
                        <span class="amenidad-label">{item.label}</span>
                    </div>
                </label>
            {/each}
        </div>
    </div>
    
    <div class="subseccion">
        <h3>UbicaciÃ³n y Ventajas del Sector</h3>
        <div class="amenidades-grid">
            {#each ubicacionVentajas as item}
                <label class="amenidad-card">
                    <input 
                        type="checkbox" 
                        bind:checked={datos[item.key]}
                    />
                    <div class="amenidad-content">
                        <span class="amenidad-icon">{item.icon}</span>
                        <span class="amenidad-label">{item.label}</span>
                    </div>
                </label>
            {/each}
        </div>
    </div>
</div>

<style>
    .paso-contenido {
        width: 100%;
    }
    
    h2 {
        font-size: 24px;
        font-weight: 700;
        color: #1f2937;
        margin: 0 0 8px 0;
    }
    
    .subtitulo {
        font-size: 14px;
        color: #6b7280;
        margin: 0 0 32px 0;
    }
    
    .subseccion {
        margin-bottom: 40px;
        padding-bottom: 40px;
        border-bottom: 2px solid #f3f4f6;
    }
    
    .subseccion:last-of-type {
        border-bottom: none;
    }
    
    .subseccion h3 {
        font-size: 18px;
        font-weight: 600;
        color: #374151;
        margin: 0 0 20px 0;
    }
    
    .amenidades-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 12px;
    }
    
    .amenidad-card {
        position: relative;
        cursor: pointer;
    }
    
    .amenidad-card input {
        position: absolute;
        opacity: 0;
        width: 0;
        height: 0;
    }
    
    .amenidad-content {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 12px 16px;
        border: 2px solid #e5e7eb;
        border-radius: 8px;
        transition: all 0.2s;
        background: white;
    }
    
    .amenidad-card:has(input:checked) .amenidad-content {
        border-color: #3b82f6;
        background: #eff6ff;
    }
    
    .amenidad-icon {
        font-size: 20px;
        flex-shrink: 0;
    }
    
    .amenidad-label {
        font-size: 14px;
        font-weight: 500;
        color: #374151;
    }
    
    @media (max-width: 768px) {
        .amenidades-grid {
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
        }
    }
    
    @media (max-width: 480px) {
        .amenidades-grid {
            grid-template-columns: 1fr;
        }
    }
</style>